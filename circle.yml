dependencies:
  override:
    - docker-compose pull
    - docker-compose up -d
    - docker-compose exec php composer config secure-http false
    - docker-compose exec php composer install -d tests --prefer-dist --no-interaction
  post:
    - cd themes/atletico; bundle install
    - tests/scripts/build.sh
test:
  override:
    - cd themes/atletico; bundle exec scss-lint
    - docker-compose exec -T php tests/bin/behat --no-colors -c tests/behat.yml -f progress
general:
  artifacts:
    - "tests/build/xml"
    - "tests/build/html"
machine:
  pre:
   - curl -sSL https://s3.amazonaws.com/circle-downloads/install-circleci-docker.sh | bash -s -- 1.10.0
   - sudo pip install docker-compose
  services:
    - docker
